{"version":3,"names":[],"mappings":"","sources":["modules/getRouteData.js"],"sourcesContent":["import GetAuthorizationHeader from \"./getAurthor.js\";\r\nimport showSearchResults from \"./showSearchResults.js\";\r\nimport searchRoutes from \"./searchRoutes.js\";\r\nimport toggleInfoPanel from \"./toggleInfoPanel.js\";\r\nimport choiceCity from \"./choiceCity.js\";\r\n\r\n\r\nexport default function getRouteDataByCity(map, lineLayers, markerLayers) {\r\n\r\n  const city = choiceCity();\r\n\r\n  axios({\r\n    method: 'get',\r\n    baseURL: 'https://ptx.transportdata.tw/MOTC/',\r\n    url: `v2/Bus/Route/City/${city}?$format=JSON`,\r\n    headers: GetAuthorizationHeader()\r\n  })\r\n    .then(res => {\r\n      const allRoutes = res.data;\r\n      showSearchResults(allRoutes, city);\r\n      toggleInfoPanel(map, lineLayers, markerLayers);\r\n\r\n      return allRoutes;\r\n    })\r\n    .then(routes => {\r\n      const searchBtn = document.querySelector('#inputSubmitBtn');\r\n      const searchInput = document.querySelector('#routeSearchInput');\r\n      const buttonKeyboard = document.querySelector('#buttonKeyboard');\r\n      \r\n      searchBtn.addEventListener('click', e => {\r\n        searchRoutes(routes, city);\r\n        toggleInfoPanel(map, lineLayers, markerLayers);\r\n      })\r\n      \r\n      searchInput.addEventListener('input', e => {\r\n        searchRoutes(routes, city);\r\n        toggleInfoPanel(map, lineLayers, markerLayers);\r\n      })\r\n      \r\n      buttonKeyboard.addEventListener('click', e => {\r\n        if (e.target.nodeName !== 'BUTTON') {\r\n          return;\r\n        }\r\n        searchRoutes(routes, city);\r\n        toggleInfoPanel(map, lineLayers, markerLayers);\r\n      })\r\n      \r\n\r\n    })\r\n    .catch(err => console.log(err));\r\n}"],"file":"getRouteData.js"}